services:
  chatbot:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "5000:5000"
    env_file:
      - ./backend/.env
    volumes:
      # Map the knowledge base so you can drop files in locally and they appear in the container
      - ./backend/knowledge_base:/app/backend/knowledge_base
      # [NEW] Map Source Code for Instant Updates (Hot Reloading)
      - ./backend:/app/backend
      - ./frontend:/app/frontend
      - ./portal:/app/portal
      # All persistent data (sessions, logs, chroma_db, portal.db) lives here
      - portal_data:/app/backend/data

volumes:
  portal_data:
